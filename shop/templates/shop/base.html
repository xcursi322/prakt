{% load static %}
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}SportShop - Спортивне харчування{% endblock %}</title>

    <!-- Tailwind CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{% static 'shop/style.css' %}">

    <script>
        (function () {
            try {
                const savedTheme = localStorage.getItem('theme');
                const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                const theme = savedTheme || (prefersDark ? 'dark' : 'light');
                if (theme === 'dark') {
                    document.documentElement.classList.add('theme-dark');
                }
            } catch (e) {
                // no-op
            }
        })();
    </script>

</head>

<body class="min-h-screen flex flex-col bg-gradient-to-br from-slate-50 to-slate-100 text-gray-900">

<!-- HEADER -->
<header class="bg-white header-shadow sticky top-0 z-30 transition-shadow">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 sm:py-4 flex justify-between items-center">
        <!-- Logo -->
        <a href="{% url 'shop:home' %}" class="flex items-center gap-3 group">
            <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-blue-800 rounded-lg flex items-center justify-center text-white font-bold text-lg group-hover:shadow-lg transition-shadow">
                <i class="fas fa-dumbbell"></i>
            </div>
            <span class="text-xl font-bold text-gray-900 hidden sm:inline group-hover:text-blue-600 transition">SportShop</span>
        </a>

        <!-- Navigation -->
        <nav class="hidden md:flex gap-8 text-sm font-medium">
            <a href="{% url 'shop:home' %}" class="text-gray-700 hover:text-blue-600 transition relative group">
                <span>Головна</span>
                <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
            </a>
            <a href="{% url 'shop:catalog' %}" class="text-gray-700 hover:text-blue-600 transition relative group">
                <span>Каталог</span>
                <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
            </a>
            <a href="{% url 'shop:delivery' %}" class="text-gray-700 hover:text-blue-600 transition relative group">
                <span>FAQ/Доставка</span>
                <span class="absolute bottom-0 left-0 w-0 h-0.5 bg-blue-600 group-hover:w-full transition-all duration-300"></span>
            </a>
        </nav>

        <!-- Right Actions -->
        <div class="flex gap-2 sm:gap-4 items-center">
            <button type="button" class="theme-toggle" data-theme-toggle aria-label="Змінити тему" title="Змінити тему">
                <i class="fas fa-moon" data-theme-icon></i>
            </button>

            <!-- Cart -->
            <a href="{% url 'shop:cart' %}" class="relative group px-3 py-2 rounded-lg hover:bg-gray-100 transition" data-cart-icon>
                <i class="fas fa-shopping-cart text-lg text-gray-700 group-hover:text-blue-600"></i>
                <span data-cart-count class="absolute -top-2 -right-2 bg-orange-500 text-white text-xs font-bold rounded-full w-5 h-5 flex items-center justify-center">{{ cart_count|default:0 }}</span>
            </a>

            <!-- User Menu -->
            {% if request.session.customer_id %}
                <div class="relative">
                    <button class="dropdown-toggle flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-gray-100 transition text-gray-700 hover:text-blue-600" title="Профіль">
                        <i class="fas fa-user text-lg"></i>
                        <span class="hidden sm:inline text-sm font-medium">{{ request.session.customer_username }}</span>
                    </button>
                    <div class="dropdown-menu">
                        <a href="{% url 'shop:profile' %}" class="">
                            <i class="fas fa-id-card text-blue-600"></i> Профіль
                        </a>
                        <a href="{% url 'shop:orders' %}">
                            <i class="fas fa-shopping-bag text-blue-600"></i> Замовлення
                        </a>
                        <a href="{% url 'shop:logout' %}" class="border-t">
                            <i class="fas fa-sign-out-alt text-red-600"></i> Вихід
                        </a>
                    </div>
                </div>
            {% else %}
                <div class="relative">
                    <button class="dropdown-toggle px-3 py-2 rounded-lg hover:bg-gray-100 transition text-gray-700 hover:text-blue-600" title="Вхід">
                        <i class="fas fa-user text-lg"></i>
                    </button>
                    <div class="dropdown-menu">
                        <a href="{% url 'shop:login' %}">
                            <i class="fas fa-sign-in-alt text-blue-600"></i> Вхід
                        </a>
                        <a href="{% url 'shop:register' %}" class="border-t">
                            <i class="fas fa-user-plus text-green-600"></i> Реєстрація
                        </a>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</header>

<!-- CONTENT -->
<main class="flex-1 w-full max-w-7xl mx-auto px-4 sm:px-6 py-8 sm:py-12">
    <div data-notifications></div>
    {% block content %}{% endblock %}
</main>

<!-- FOOTER -->
<footer class="bg-gradient-to-b from-gray-900 to-gray-950 text-gray-300 mt-16 border-t border-gray-800">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-12 sm:py-16">
        <!-- Top Section -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8 mb-12 pb-12 border-b border-gray-800">
            <!-- Company Info -->
            <div class="fade-in-up">
                <div class="flex items-center gap-2 mb-4">
                    <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-700 rounded-lg flex items-center justify-center text-white font-bold">
                        <i class="fas fa-dumbbell text-sm"></i>
                    </div>
                    <h3 class="font-bold text-white text-lg">SportShop</h3>
                </div>
                <p class="text-sm text-gray-400 leading-relaxed">
                    Ваш надійний партнер у світі спортивного харчування та здорового способу життя.
                </p>
            </div>

            <!-- Links 1 -->
            <div class="fade-in-up">
                <h4 class="font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-link text-blue-500"></i> Про магазин
                </h4>
                <ul class="space-y-2 text-sm">
                    <li><a href="#" class="text-gray-400 hover:text-blue-400 transition flex items-center gap-1">
                        <i class="fas fa-chevron-right text-xs"></i> Про нас
                    </a></li>
                    <li><a href="{% url 'shop:delivery' %}" class="text-gray-400 hover:text-blue-400 transition flex items-center gap-1">
                        <i class="fas fa-chevron-right text-xs"></i> Доставка
                    </a></li>
                    <li><a href="#" class="text-gray-400 hover:text-blue-400 transition flex items-center gap-1">
                        <i class="fas fa-chevron-right text-xs"></i> Повернення
                    </a></li>
                </ul>
            </div>

            <!-- Links 2 -->
            <div class="fade-in-up">
                <h4 class="font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-headset text-blue-500"></i> Допомога
                </h4>
                <ul class="space-y-2 text-sm">
                    <li><a href="#" class="text-gray-400 hover:text-blue-400 transition flex items-center gap-1">
                        <i class="fas fa-chevron-right text-xs"></i> Контакти
                    </a></li>
                    <li><a href="#" class="text-gray-400 hover:text-blue-400 transition flex items-center gap-1">
                        <i class="fas fa-chevron-right text-xs"></i> Питання-Відповіді
                    </a></li>
                    <li><a href="#" class="text-gray-400 hover:text-blue-400 transition flex items-center gap-1">
                        <i class="fas fa-chevron-right text-xs"></i> Умови
                    </a></li>
                </ul>
            </div>

            <!-- Contacts & Social -->
            <div class="fade-in-up">
                <h4 class="font-bold text-white mb-4 flex items-center gap-2">
                    <i class="fas fa-share-nodes text-blue-500"></i> Контакти
                </h4>
                <ul class="space-y-2 text-sm mb-6">
                    <li class="flex items-center gap-2 text-gray-400">
                        <i class="fas fa-phone text-blue-500"></i> +38 (095) 123-45-67
                    </li>
                    <li class="flex items-center gap-2 text-gray-400">
                        <i class="fas fa-envelope text-blue-500"></i> info@sportshop.ua
                    </li>
                    <li class="flex items-center gap-2 text-gray-400">
                        <i class="fas fa-map-marker-alt text-blue-500"></i> м. Київ
                    </li>
                </ul>
                <div class="flex gap-3">
                    <a href="#" class="w-9 h-9 rounded-lg bg-gray-800 hover:bg-blue-600 flex items-center justify-center transition transform hover:scale-110" title="Facebook">
                        <i class="fab fa-facebook-f text-sm"></i>
                    </a>
                    <a href="#" class="w-9 h-9 rounded-lg bg-gray-800 hover:bg-pink-600 flex items-center justify-center transition transform hover:scale-110" title="Instagram">
                        <i class="fab fa-instagram text-sm"></i>
                    </a>
                    <a href="#" class="w-9 h-9 rounded-lg bg-gray-800 hover:bg-blue-500 flex items-center justify-center transition transform hover:scale-110" title="Twitter">
                        <i class="fab fa-twitter text-sm"></i>
                    </a>
                    <a href="#" class="w-9 h-9 rounded-lg bg-gray-800 hover:bg-red-600 flex items-center justify-center transition transform hover:scale-110" title="YouTube">
                        <i class="fab fa-youtube text-sm"></i>
                    </a>
                </div>
            </div>
        </div>

        <!-- Bottom Section -->
        <div class="flex flex-col sm:flex-row justify-between items-center gap-4">
            <p class="text-sm text-gray-500">© 2026 SportShop. Всі права захищені.</p>
            <div class="flex gap-6 text-sm text-gray-500">
                <a href="#" class="hover:text-blue-400 transition">Політика приватності</a>
                <a href="#" class="hover:text-blue-400 transition">Умови обслуговування</a>
            </div>
        </div>
    </div>
</footer>

<!-- Main Scripts -->
<script src="{% static 'shop/filters.js' %}"></script>

<script>
    // Enhanced dropdown menu handler with smooth animations
    document.querySelectorAll('.dropdown-toggle').forEach(toggle => {
        const menu = toggle.nextElementSibling;
        
        if (menu && menu.classList.contains('dropdown-menu')) {
            toggle.addEventListener('click', (e) => {
                e.preventDefault();
                const isOpen = menu.classList.contains('show');
                
                // Close all other dropdowns
                document.querySelectorAll('.dropdown-menu.show').forEach(m => {
                    if (m !== menu) m.classList.remove('show');
                });
                
                // Toggle current menu
                menu.classList.toggle('show');
            });
            
            // Close menu when clicking outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.dropdown-toggle') && !e.target.closest('.dropdown-menu')) {
                    menu.classList.remove('show');
                }
            });

            // Keyboard navigation
            toggle.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    menu.classList.add('show');
                    const firstLink = menu.querySelector('a');
                    if (firstLink) firstLink.focus();
                }
                if (e.key === 'Escape') {
                    menu.classList.remove('show');
                    toggle.focus();
                }
            });
        }
    });

    // Smooth scroll behavior
    if (!('scrollBehavior' in document.documentElement.style)) {
        const links = document.querySelectorAll('a[href^="#"]');
        links.forEach(link => {
            link.addEventListener('click', (e) => {
                const href = link.getAttribute('href');
                if (href !== '#') {
                    const target = document.querySelector(href);
                    if (target) {
                        e.preventDefault();
                        target.scrollIntoView({ behavior: 'smooth' });
                    }
                }
            });
        });
    }

    // Page load animation
    window.addEventListener('load', () => {
        document.body.style.opacity = '1';
    });

    // Add loading state on form submissions
    document.querySelectorAll('form').forEach(form => {
        form.addEventListener('submit', () => {
            const submitBtn = form.querySelector('button[type="submit"]');
            if (submitBtn) {
                submitBtn.disabled = true;
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Завантаження...';
            }
        });
    });

    // Theme toggle
    (function setupThemeToggle() {
        const root = document.documentElement;
        const toggleBtn = document.querySelector('[data-theme-toggle]');
        const icon = document.querySelector('[data-theme-icon]');

        if (!toggleBtn || !icon) {
            return;
        }

        const syncIcon = () => {
            const isDark = root.classList.contains('theme-dark');
            icon.classList.remove('fa-moon', 'fa-sun');
            icon.classList.add(isDark ? 'fa-sun' : 'fa-moon');
        };

        syncIcon();

        toggleBtn.addEventListener('click', () => {
            const isDark = root.classList.toggle('theme-dark');
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
            syncIcon();
        });
    })();
</script>

{% block extra_js %}{% endblock %}

</body>
</html>
